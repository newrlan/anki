# Anki
For learning English words and phrases.

## Userstory

### Add word
Добавляем фразу, слово которое хотим выучить оборачиваем в звездочки. Через слеш добавляем перевод *слова*. 

```bash
Where are you *from*? \ откуда
*I can tall* \ по тебе видно
```

Если добавляет слово которое уже есть в базе, то обновляются возможные переводы и контекст слова через добавление.

Под капотом формируется словарная карточка состоящая из слова, контекста, и перевода.

Слово выделяется из поступившей фразы, приводится в нормальную форму. Далее слово будет ключем базе данных.

Контекст формируется из поступившей фразы, изучаемое слово заменяется на подчеркивание, в конце если необходимо указывается окончание, а в случае неправильных глаголов указатель на вторую или третью форму.

### Edit word
TODO

### Learning mode
TODO

## Math
Логика подбора слов из базы для повторения реализована на многоруких бандитах. Использовалось [динамическая Гамма-Пуассоновская модель](https://habr.com/ru/companies/surfingbird/articles/169573). Итоговые формулы обновления параметров модели следующие:

Инициализация:
$$\mu_0 = 1, \sigma_0 = 1, \eta=1$$

Промежуточные параметры:

$$ \gamma_t = \mu_t / \sigma_t^2$$
$$\gamma_{t|t} = \gamma_t + n_t $$
$$ \mu_{t|t} = \frac{\mu_t \gamma_t + r_t}{\gamma_{t|t}} $$
$$ \sigma_{t|t}^2 = \mu_{t|t} / \gamma_{t|t} $$

Обновление параметров:

$$ \mu_{t+1} = \mu_{t|t} $$
$$ \sigma_{t+1}^2 = \sigma_{t|t}^2 + \eta (\mu_{t|t}^2 + \sigma_{t|t}^2) $$

Здесь $n_t$ общее количество показов слова на итерации $t$, $r_t$ общее количество успехов (не вспомнил) на итерации $t$, $\mu_t$ и $\sigma_t$ -- обновленные параметры гамма-распределения.
